---
## Front matter
title: "Лабораторная работа № 12"
subtitle: "Настройка NAT"
author: "Хватов Максим Григорьевич"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: false # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Приобрести практические навыки по настройке доступа локальной сети к внешней сети посредством NAT.

# Задание

1. Сделать первоначальную настройку маршрутизатора provider-gw-1 и коммутатора provider-sw-1 провайдера: задать имя, настроить доступ по
паролю и т.п.
2. Настроить интерфейсы маршрутизатора provider-gw-1 и коммутатора
provider-sw-1 провайдера.
3. Настроить интерфейсы маршрутизатора сети «Донская» для доступа к сети
провайдера.
4. Настроить на маршрутизаторе сети «Донская» NAT с правилами.
5. Настроить доступ из внешней сети в локальную сеть организации.
6. Проверить работоспособность заданных настроек.
7. При выполнении работы необходимо учитывать соглашение об именовании.

# Выполнение лабораторной работы

Проведем первоначальную настройку маршрутизатора provider-gw-1 (рис. [-@fig:001]). Зададим имя, настроим доступ по паролю.

![Первоначальная настройка маршрутизатора provider-gw-1](image/1.png){#fig:001 width=70%}

Проведем первоначальную настройку коммутатора provider-sw-1 (рис. [-@fig:002]). Зададим имя, настроим доступ по паролю.

![Первоначальная настройка коммутатора provider-sw-1](image/2.png){#fig:002 width=70%}

Проведем настройку интерфейсов маршрутизатора provider-gw-1 (рис. [-@fig:003]). Поднимем интерфейс f0/0, создадим интерфейс f0/0.4 для 4 vlan и зададим ip-адрес, поднимем интерфейс f0/1.

![Настройка интерфейсов маршрутизатора provider-gw-1](image/3.png){#fig:003 width=70%}

Проведем настройку интерфейсов коммутатора provider-sw-1 (рис. [-@fig:004]). Сделаем порты f0/1 и f0/2 транковыми, зададим 4 vlan с именем nat.

![Настройка интерфейсов коммутатора provider-sw-1](image/5.png){#fig:0041 width=70%}

![Настройка интерфейсов коммутатора provider-sw-1](image/6.png){#fig:004 width=70%}

Проведем настройку интерфейсов маршрутизатора msk-donskaya-gw-1. Поднимем интерфейс f0/1, создадим интерфейс f0/1.4 для 4 vlan и зададим ip-адрес.

![Настройка интерфейсов маршрутизатора msk-donskaya-gw-1](image/8.png){#fig:005 width=70%}

Пропингую адрес 192.0.2.1. Пинг проходит успешно

![Проверка доступности маршрутизатора](image/4.png){#fig:006 width=70%}

НАзначу роут по умолчанию для gw-1.

![Настройка роута по умолчанию](image/9.png){#fig:007 width=70%}

Попытка пропинговать устройство 198.51.100.1 оказывается неудачной и для этого я разорвал связь, и тогда все заработало.

![Попытка пропинговать 198.51.100.1](image/11.png){#fig:0081 width=70%}

![Настройка пула адресов](image/11.png){#fig:008 width=70%}

Настроим Port Address Translation (PAT) на субинтерфейсах маршрутизатора с территории Донская (рис. [-@fig:009]).

![Настройка PAT](image/17.png){#fig:009 width=70%}

Добавил ноутбук laptop-ext в схему в область internet.
Проверка доступности к маршрутизаторам от ноутбука админ. Все доступны.

![Пинг](image/13.png){#fig:0091 width=70%}

![Пинг](image/14.png){#fig:0092 width=70%}

![Пинг](image/15.png){#fig:0093 width=70%}

Проверил возможность выхода в интрнет после всех настроек

![www.yandex.ru](image/16.png){#fig:00936 width=70%}

Страница отобразилась. Также проверил через браузер на устройстве laptop-ext доступ к адресу 198.51.100.2, он оказался доступен тоже.

![198.51.100.2](image/18.png){#fig:00935 width=70%}

# Выводы

В результате выполнения данной лабораторной работы я приобрел практические навыки по настройке доступа локальной сети к внешней сети посредством NAT.

# Контрольные вопросы

1. В чём состоит основной принцип работы NAT (что даёт наличие NAT в сети
организации)?

Идея NAT заключается в том, чтобы осуществлять перевод частного локального IP-адреса в общедоступный глобальный IP-адрес и наоборот. Это необходимо для обеспечения доступа к Интернету локальным узлам, использующим частные адреса.

Наличие NAT в сети организации позволяет экономить публичные IP-адреса и повышать безопасность защитой внутренних устройств от прямого доступа извне.

2. В чём состоит принцип настройки NAT (на каком оборудовании и что
нужно настроить для из локальной сети во внешнюю сеть через NAT)?

Как правило, граничный маршрутизатор настроен для NAT, то есть маршрутизатор, который имеет один интерфейс в локальной (внутренней, inside) сети и один интерфейс в глобальной (внешней, outside) сети. Когда пакет проходит за пределы локальной (inside) сети, NAT преобразует локальный (частный, private) IP-адрес в глобальный (публичный, public) IP-адрес. Когда пакет входит в локальную сеть, глобальный (public) IP-адрес преобразуется в локальный (private) IP-адрес. Граничный маршрутизатор выступает в роли шлюза между внутренней корпоративной сетью и внешней сетью, например, Интернетом.

3. Можно ли применить Cisco IOS NAT к субинтерфейсам?

Да. Преобразования NAT источника или назначения могут применяться к любому интерфейсу или подинтерфейсу с
IP-адресом (включая интерфейсы программы набора номера).

4. Что такое пулы IP NAT?

Пул NAT — это набор из одного или нескольких общедоступных IPv4-адресов, которые используются в маршрутизаторе NAT.

При отправке трафика устройством из внутренней сети во внешнюю сеть маршрутизатор преобразует его внутренний IPv4-адрес в один из адресов, входящих в состав пула.

В результате действия такого механизма весь исходящий из сети трафик внешние устройства «видят» с общедоступным адресом IPv4, который можно назвать NAT IP-адресом.

5. Что такое статические преобразования NAT?

Статическое преобразование сетевых адресов (NAT) выполняет взаимно однозначное преобразование внутренних IP-адресов во внешние. Это позволяет преобразовать IP-адрес внутренней сети во внешний IP-адрес. Статический NAT позволяет устанавливать соединения как внутренним, так и внешним системам, например, хостам Internet.